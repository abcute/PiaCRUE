# Conceptual Log Generation from PiaSE Scenarios using `prototype_logger.py`

## Introduction

This document illustrates how the `prototype_logger.py` (from `PiaAGI_Research_Tools.PiaAVT.prototype_logger`) could be conceptually integrated within PiaSE (Pia Simulation Engine) scenarios. The goal is to generate structured logs that conform to the `Logging_Specification.md`, thereby enabling analysis by the PiaAVT (Pia Analysis and Visualization Toolkit) tools. It bridges PiaSE's simulation events with the data requirements of PiaAVT.

## Assumptions

1.  **Logger Availability:** The PiaSE simulation engine can import and instantiate the `PrototypeLogger` class from `PiaAGI_Research_Tools.PiaAVT.prototype_logger`. An instance of the logger would be available to relevant PiaSE components.
2.  **Identifier Management:** PiaSE has established mechanisms to consistently identify and provide:
    *   `agent_id`: A unique identifier for each agent participating in the simulation.
    *   `simulation_run_id`: A unique identifier for each execution of a simulation scenario.
    *   `experiment_id`: (Optional but recommended) An identifier for a set of related simulation runs.
3.  **Logging Hooks:** PiaSE components (e.g., environment controllers, agent wrappers, internal agent modules) have designated points where they can invoke the logger's `log_event` method with appropriate details.

## Conceptual Integration Points for `Curiosity_Scenario.md`

The `Curiosity_Scenario.md` likely involves an agent encountering novel or surprising stimuli, prompting exploration and learning. Here's how logging could be integrated:

### 1. Agent Senses a Novel Artifact

*   **PiaSE Event:** The agent's perception system processes a new or unexpected artifact in the environment.
*   **`log_event` Call:**
    ```python
    logger.log_event(
        timestamp=current_sim_time, # Provided by PiaSE
        simulation_run_id="cur_sim_001",
        experiment_id="exp_curiosity_study_A",
        agent_id="agent_curious_01",
        source_component_id="PiaAgent.PerceptionSystem", 
        event_type="PERCEPTION_INPUT_PROCESSED",
        event_data={
            "stimulus_id": "artifact_xyz",
            "modality": "visual",
            "attributes": {"shape": "cube", "color": "blue", "material": "unknown"},
            "novelty_score": 0.95, # Calculated by the perception or novelty detection system
            "complexity_score": 0.7,
            "recognized_as": None # Initially unknown
        },
        event_id="evt_perc_001" # Unique event ID generated by logger or PiaSE
    )
    ```
*   **Rationale:** This log captures the raw perceptual input and associated novelty metrics, crucial for `IntrinsicMotivationAnalysis`.

### 2. Agent Internally Generates a Curiosity-Driven Goal

*   **PiaSE Event:** Based on the novel perception, the agent's motivational or goal generation system creates an intrinsic goal to investigate.
*   **`log_event` Call:**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="cur_sim_001",
        agent_id="agent_curious_01",
        source_component_id="PiaAgent.MotivationalSystem",
        event_type="GOAL_CREATED",
        event_data={
            "goal_id": "intrinsic_cur_artifact_xyz_01",
            "type": "INTRINSIC_CURIOSITY", # From Logging_Specification.md
            "target_stimulus_id": "artifact_xyz",
            "source_trigger_event_id": "evt_perc_001", # Links to the perception event
            "urgency": 0.8,
            "goal_description": "Investigate novel blue cube artifact_xyz"
        },
        event_id="evt_goal_001"
    )
    ```
*   **Rationale:** Logs the creation of an intrinsic goal, essential for `IntrinsicMotivationAnalysis` and potentially `TaskPerformanceAnalysis` if curiosity leads to a formal task.

### 3. Agent Moves Towards the Artifact

*   **PiaSE Event:** The agent decides to act on its curiosity goal and executes a movement action.
*   **`log_event` Call:**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="cur_sim_001",
        agent_id="agent_curious_01", # Agent performing the action
        source_component_id="PiaAgent.ActionExecution", # Or PiaSE.Environment if logging agent's effect
        event_type="AGENT_ACTION_EXECUTED_IN_ENV",
        event_data={
            "agent_id_acting": "agent_curious_01",
            "action_name": "move_to_object",
            "target_id": "artifact_xyz",
            "path_taken": [[x1,y1], [x2,y2], ...], # Optional details
            "related_goal_id": "intrinsic_cur_artifact_xyz_01"
        },
        event_id="evt_act_001"
    )
    ```
*   **Rationale:** Captures agent behavior driven by the intrinsic goal.

### 4. Agent Interacts with the Artifact

*   **PiaSE Event:** The agent performs an interaction action (e.g., "touch", "inspect") with the artifact.
*   **`log_event` Call:**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="cur_sim_001",
        agent_id="agent_curious_01",
        source_component_id="PiaAgent.ActionExecution",
        event_type="AGENT_ACTION_EXECUTED_IN_ENV",
        event_data={
            "agent_id_acting": "agent_curious_01",
            "action_name": "inspect_object",
            "target_id": "artifact_xyz",
            "outcome_observed_by_agent": "Object is cold and smooth.", # Agent's own observation from interaction
            "related_goal_id": "intrinsic_cur_artifact_xyz_01"
        },
        event_id="evt_act_002"
    )
    ```
*   **Rationale:** Further behavioral data. The `outcome_observed_by_agent` could be input for further cognitive processing.

### 5. Environment Provides Feedback / Artifact Properties Revealed

*   **PiaSE Event:** The environment (or the artifact itself as an environment component) reveals properties upon interaction.
*   **`log_event` Call:**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="cur_sim_001",
        # No specific agent_id if this is an environment emission, or agent_id if it's a direct consequence for the agent
        source_component_id="PiaSE.CuriosityArtifact", 
        event_type="ENVIRONMENT_STATE_UPDATE", # Or a more specific custom event type
        event_data={
            "object_id": "artifact_xyz",
            "revealed_properties": {"material": "metallic", "temperature_change": -5.0},
            "interaction_type_trigger": "inspect_object",
            "recipient_agent_id": "agent_curious_01" # Agent who caused/benefits from this update
        },
        event_id="evt_env_001"
    )
    ```
*   **Rationale:** Captures environmental responses that can lead to learning or goal satisfaction.

### 6. Agent Experiences Intrinsic Reward

*   **PiaSE Event:** After successful investigation that reduces uncertainty or satisfies curiosity, the agent's internal system generates an intrinsic reward.
*   **`log_event` Call:**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="cur_sim_001",
        agent_id="agent_curious_01",
        source_component_id="PiaAgent.RewardSystem",
        event_type="INTRINSIC_REWARD_GENERATED",
        event_data={
            "reward_type": "CURIOSITY_SATISFIED", # Or "NOVELTY_REDUCTION"
            "value": 0.75, # Arbitrary scale
            "related_goal_id": "intrinsic_cur_artifact_xyz_01",
            "source_event_ids": ["evt_act_002", "evt_env_001"] # Events that led to satisfaction
        },
        event_id="evt_ir_001"
    )
    ```
*   **Rationale:** Key for `IntrinsicMotivationAnalysis`, linking behavior to internal reward signals. This could also affect the agent's VAD balance for `EmotionalStateTrajectoryAnalysis`.

## Conceptual Integration Points for `Competence_Scenario.md`

The `Competence_Scenario.md` likely involves an agent attempting tasks, potentially failing, learning, and improving its skills to achieve competence.

### 1. Task Assigned or Agent Adopts a Competence-Driven Goal

*   **PiaSE Event:** A task is assigned, or the agent identifies a need to improve a skill, leading to a competence goal.
*   **`log_event` Call (Goal Creation):**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="comp_sim_001",
        agent_id="agent_competent_01",
        source_component_id="PiaAgent.GoalSystem",
        event_type="GOAL_CREATED",
        event_data={
            "goal_id": "intrinsic_comp_skill_X_01",
            "type": "INTRINSIC_COMPETENCE",
            "target_skill_id": "skill_X",
            "desired_level": 3,
            "reason": "Observed repeated failure in tasks requiring skill_X"
            # "source_trigger_event_id": "evt_taskfail_002" // Optional, if triggered by a specific event
        },
        event_id="evt_goal_c_001"
    )
    ```
*   **`log_event` Call (Task Status if external):**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="comp_sim_001",
        # agent_id might be system if task is environment-assigned, or agent if self-assigned
        source_component_id="PiaSE.TaskManager",
        event_type="TASK_STATUS_UPDATE",
        event_data={
            "task_id": "task_complex_001",
            "status": "ASSIGNED", # or "STARTED" if agent immediately starts
            "task_description": "Assemble widget using skill_X and skill_Y",
            "assigned_to_agent_id": "agent_competent_01",
            "required_skills": [{"skill_id": "skill_X", "level": 2}, {"skill_id": "skill_Y", "level": 1}]
        },
        event_id="evt_task_001"
    )
    ```
*   **Rationale:** Sets the context for competence-driven actions and task performance analysis.

### 2. Agent Attempts an Action Related to the Task/Skill

*   **PiaSE Event:** Agent tries to perform an action, e.g., "craft_item_A" using "skill_X".
*   **`log_event` Call:**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="comp_sim_001",
        agent_id="agent_competent_01",
        source_component_id="PiaAgent.ActionExecution",
        event_type="AGENT_ACTION_ATTEMPTED", # Could also be AGENT_ACTION_EXECUTED_IN_ENV
        event_data={
            "agent_id_acting": "agent_competent_01",
            "action_name": "craft_item_A",
            "used_skill_id": "skill_X",
            "current_skill_level_assumed": 1, # Agent's belief at time of action
            "related_task_id": "task_complex_001",
            "related_goal_id": "intrinsic_comp_skill_X_01"
        },
        event_id="evt_act_c_001"
    )
    ```
*   **Rationale:** Logs attempts, which are important if they can lead to different outcomes (success/failure).

### 3. Action Outcome (Failure/Success)

*   **PiaSE Event:** The environment or internal check determines if the action succeeded or failed.
*   **`log_event` Call (Example: Failure):**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="comp_sim_001",
        agent_id="agent_competent_01", # Agent who experiences this outcome
        source_component_id="PiaSE.EnvironmentFeedback", # Or PiaAgent.ActionExecution if self-diagnosed
        event_type="AGENT_ACTION_OUTCOME", # Custom event type
        event_data={
            "action_attempt_event_id": "evt_act_c_001",
            "outcome": "FAILURE",
            "reason": "Skill level too low", # Or "Materials incorrect"
            "consequence_description": "Widget component broke"
        },
        event_id="evt_out_c_001"
    )
    ```
*   **Rationale:** Critical for learning and competence tracking. Failures might trigger negative VAD changes for `EmotionalStateTrajectoryAnalysis`.

### 4. Agent's Skill Level is Updated (Self-Model Update)

*   **PiaSE Event:** Based on practice, success, or failure analysis, the agent's internal model of its skill level changes.
*   **`log_event` Call:**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="comp_sim_001",
        agent_id="agent_competent_01",
        source_component_id="PiaAgent.SelfModel",
        event_type="SELFMODEL_ATTRIBUTE_UPDATED",
        event_data={
            "attribute_name": "skill_level",
            "attribute_details": {"skill_id": "skill_X"},
            "old_value": 1,
            "new_value": 1.2, # Incremental improvement from practice/learning
            "change_reason": "Practice session after failure (evt_out_c_001)"
        },
        event_id="evt_sm_c_001"
    )
    ```
*   **Rationale:** Tracks changes in agent capabilities, important for `IntrinsicMotivationAnalysis` (competence) and understanding long-term adaptation.

### 5. Task Status Update (Completion/Failure)

*   **PiaSE Event:** The overall task reaches a terminal state.
*   **`log_event` Call (Example: Success after skill improvement):**
    ```python
    logger.log_event(
        timestamp=current_sim_time,
        simulation_run_id="comp_sim_001",
        source_component_id="PiaSE.TaskManager", # Or agent if self-completing
        event_type="TASK_STATUS_UPDATE",
        event_data={
            "task_id": "task_complex_001",
            "status": "COMPLETED_SUCCESS",
            "final_outcome_description": "Widget assembled perfectly.",
            "agent_id_responsible": "agent_competent_01"
        },
        event_id="evt_task_c_002"
    )
    ```
*   **Rationale:** Feeds directly into `TaskPerformanceAnalysis`. Success here could also generate an intrinsic reward for competence.


## Example Log Snippet (JSONL)

This snippet illustrates a few lines that might be generated from the **Curiosity Scenario**:

```json
{"timestamp": 1678886405.0, "simulation_run_id": "cur_sim_001", "experiment_id": "exp_curiosity_study_A", "agent_id": "agent_curious_01", "source_component_id": "PiaAgent.PerceptionSystem", "event_type": "PERCEPTION_INPUT_PROCESSED", "event_data": {"stimulus_id": "artifact_xyz", "modality": "visual", "attributes": {"shape": "cube", "color": "blue"}, "novelty_score": 0.95, "complexity_score": 0.7}, "event_id": "evt_perc_001"}
{"timestamp": 1678886407.0, "simulation_run_id": "cur_sim_001", "experiment_id": "exp_curiosity_study_A", "agent_id": "agent_curious_01", "source_component_id": "PiaAgent.MotivationalSystem", "event_type": "GOAL_CREATED", "event_data": {"goal_id": "intrinsic_cur_artifact_xyz_01", "type": "INTRINSIC_CURIOSITY", "target_stimulus_id": "artifact_xyz", "source_trigger_event_id": "evt_perc_001", "urgency": 0.8}, "event_id": "evt_goal_001"}
{"timestamp": 1678886408.0, "simulation_run_id": "cur_sim_001", "experiment_id": "exp_curiosity_study_A", "agent_id": "agent_curious_01", "source_component_id": "PiaAgent.ActionExecution", "event_type": "AGENT_ACTION_EXECUTED_IN_ENV", "event_data": {"agent_id_acting": "agent_curious_01", "action_name": "move_to_object", "target_id": "artifact_xyz", "related_goal_id": "intrinsic_cur_artifact_xyz_01"}, "event_id": "evt_act_001"}
{"timestamp": 1678886409.0, "simulation_run_id": "cur_sim_001", "experiment_id": "exp_curiosity_study_A", "agent_id": "agent_curious_01", "source_component_id": "PiaAgent.RewardSystem", "event_type": "INTRINSIC_REWARD_GENERATED", "event_data": {"reward_type": "CURIOSITY_SATISFIED", "value": 0.75, "related_goal_id": "intrinsic_cur_artifact_xyz_01"}, "event_id": "evt_ir_001"}
```

## Conclusion

This document provides a conceptual guide for instrumenting PiaSE scenarios with `prototype_logger.py`. By embedding these kinds of `log_event` calls at key junctures within a simulation, PiaSE can produce rich, structured logs. These logs, adhering to the `Logging_Specification.md`, are then directly usable by the PiaAVT analysis scripts, enabling deeper insights into agent behavior, internal states, and performance across various scenarios. The actual implementation would require careful mapping of PiaSE's internal events and data structures to the fields expected by the logger.
